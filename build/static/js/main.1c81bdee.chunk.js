(this["webpackJsonpchat-lite"]=this["webpackJsonpchat-lite"]||[]).push([[0],{46:function(e,t,a){e.exports=a(95)},91:function(e,t){},94:function(e,t,a){},95:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(42),s=a.n(c),o=a(7),l=a.n(o),u=a(11),m=a(4),i=a(13),E=a.n(i),d=a(43),p=a.n(d)()(),f=a(45),b=a(3),h=function(e,t){switch(t.type){case"ENTERED":return Object(b.a)(Object(b.a)({},e),{},{joined:!0,user:t.payload.user,room:t.payload.room});case"SET_DATA":return Object(b.a)(Object(b.a)({},e),{},{users:t.payload.users,messages:t.payload.messages});case"SET_USERS":return Object(b.a)(Object(b.a)({},e),{},{users:t.payload});case"NEW_MESSAGE":return Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(f.a)(e.messages),[t.payload])});default:return e}};var g=function(e){var t=e.onLogin,a=r.a.useState(""),n=Object(m.a)(a,2),c=n[0],s=n[1],o=r.a.useState(!1),i=Object(m.a)(o,2),d=i[0],p=i[1],f=window.location.href,b=f.match("/room/(.*)")?f.match("/room/(.*)")[1]:window.location.href=f+"/room/"+Math.floor(9e6*Math.random())+1,h=function(){var e=Object(u.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return",alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0438\u043a"));case 2:return a={room:b,user:c},p(!0),e.next=6,E.a.post("/room",a);case 6:t(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"login"},r.a.createElement("input",{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0438\u043a",value:c,onChange:function(e){s(e.target.value)}}),r.a.createElement("button",{disabled:d,onClick:h,className:"btn btn-success"},d?"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435...":"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0447\u0430\u0442"))},v=a(44);var O=function(e){var t=e.users,a=e.messages,n=e.user,c=e.room,s=e.onAddMessage,o=r.a.useState(""),l=Object(m.a)(o,2),u=l[0],i=l[1],E=r.a.useRef(null);return r.a.useEffect((function(){E.current.scroll(0,E.current.scrollHeight)}),[a]),r.a.createElement("div",null,r.a.createElement("h4",{className:"mb-4 text-center"},"\u0412\u044b \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0435\u0441\u044c \u0432 \u0447\u0430\u0442\u0435-\u043a\u043e\u043c\u043d\u0430\u0442\u0435: ",r.a.createElement("b",null,c)),r.a.createElement("h6",{className:"mb-4 text-center"},"\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u0432 \u0447\u0430\u0442:",r.a.createElement("a",{href:"/room/"+c,target:"_blank",rel:"noopener noreferrer"},window.location.host+"/room/"+c)),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat-users"},"\u0412\u044b: ",r.a.createElement("b",null,n),r.a.createElement("hr",null),r.a.createElement("p",null,"\u041e\u043d\u043b\u0430\u0439\u043d (",t.length,"):"),r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement("li",null,e,r.a.createElement("span",{className:"position-absolute top-0 start-100 translate-middle p-1 bg-success border border-light rounded-circle text-center"}))})))),r.a.createElement("div",{className:"chat-messages"},r.a.createElement("div",{ref:E,className:"messages"},a.map((function(e){return r.a.createElement("div",{className:e.user===n?"your-message":"message"},r.a.createElement("p",null,e.text,r.a.createElement("br",null)),r.a.createElement("div",null,r.a.createElement("span",null,e.user===n?"("+e.time+") \u0412\u044b":e.user+" ("+e.time+")")))}))),r.a.createElement("form",null,r.a.createElement("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end"},r.a.createElement("textarea",{value:u,onChange:function(e){return i(e.target.value)},className:"form-control",rows:"1"}),r.a.createElement("button",{onClick:function(){var e=new Date,t=v.a.format(e,"DD.MM.YY HH:mm");p.emit("ROOM:NEW_MESSAGE",{room:c,user:n,time:t,text:u}),s({user:n,time:t,text:u}),i("")},type:"button",className:"btn btn-success ml-2 btn-send"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))))))};var S=function(){var e=r.a.useReducer(h,{joined:!1,room:null,user:null,users:[],messages:[]}),t=Object(m.a)(e,2),a=t[0],n=t[1],c=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"ENTERED",payload:t}),p.emit("ROOM:ENTER",t),e.next=4,E.a.get("/room/".concat(t.room));case 4:a=e.sent,r=a.data,n({type:"SET_DATA",payload:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(e){n({type:"SET_USERS",payload:e})},o=function(e){n({type:"NEW_MESSAGE",payload:e})};return r.a.useEffect((function(){p.on("ROOM:SET_USERS",s),p.on("ROOM:NEW_MESSAGE",o)}),[]),r.a.createElement("div",{className:"main"},a.joined?r.a.createElement(O,Object.assign({},a,{onAddMessage:o})):r.a.createElement(g,{onLogin:c}))};a(94);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.1c81bdee.chunk.js.map